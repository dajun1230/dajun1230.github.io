<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>经典案例 | 小杨--个人笔记</title>
    <meta name="description" content="详情描述">
    <link rel="icon" href="/iamges/favicons.ico">
    
    <link rel="preload" href="/assets/css/0.styles.56c699db.css" as="style"><link rel="preload" href="/assets/js/app.af8c451a.js" as="script"><link rel="preload" href="/assets/js/34.00f8c821.js" as="script"><link rel="prefetch" href="/assets/js/10.f9ce7cc1.js"><link rel="prefetch" href="/assets/js/11.dffd68cf.js"><link rel="prefetch" href="/assets/js/12.88b968c3.js"><link rel="prefetch" href="/assets/js/13.ee021609.js"><link rel="prefetch" href="/assets/js/14.0d9da61d.js"><link rel="prefetch" href="/assets/js/15.cf7a716a.js"><link rel="prefetch" href="/assets/js/16.68eea69c.js"><link rel="prefetch" href="/assets/js/17.9c9ed280.js"><link rel="prefetch" href="/assets/js/18.3fd6d31e.js"><link rel="prefetch" href="/assets/js/19.d2c7fa8e.js"><link rel="prefetch" href="/assets/js/2.c36408f4.js"><link rel="prefetch" href="/assets/js/20.ad9fa36b.js"><link rel="prefetch" href="/assets/js/21.3829d637.js"><link rel="prefetch" href="/assets/js/22.6294a8c2.js"><link rel="prefetch" href="/assets/js/23.16fcadda.js"><link rel="prefetch" href="/assets/js/24.9f3982d3.js"><link rel="prefetch" href="/assets/js/25.cdd1e6a9.js"><link rel="prefetch" href="/assets/js/26.18563480.js"><link rel="prefetch" href="/assets/js/27.4705311f.js"><link rel="prefetch" href="/assets/js/28.09fcc8b4.js"><link rel="prefetch" href="/assets/js/29.44f1703f.js"><link rel="prefetch" href="/assets/js/3.b8072446.js"><link rel="prefetch" href="/assets/js/30.adbb594e.js"><link rel="prefetch" href="/assets/js/31.00599d01.js"><link rel="prefetch" href="/assets/js/32.61ba3371.js"><link rel="prefetch" href="/assets/js/33.8420b93c.js"><link rel="prefetch" href="/assets/js/35.1141f38d.js"><link rel="prefetch" href="/assets/js/36.366705ba.js"><link rel="prefetch" href="/assets/js/37.edb9b8b9.js"><link rel="prefetch" href="/assets/js/38.b440a287.js"><link rel="prefetch" href="/assets/js/39.e9b1aaa4.js"><link rel="prefetch" href="/assets/js/4.1c4d5fc0.js"><link rel="prefetch" href="/assets/js/40.16da07a5.js"><link rel="prefetch" href="/assets/js/41.350c3c58.js"><link rel="prefetch" href="/assets/js/42.ab0911d4.js"><link rel="prefetch" href="/assets/js/43.994d22b7.js"><link rel="prefetch" href="/assets/js/44.48fc8e1b.js"><link rel="prefetch" href="/assets/js/45.29742ea8.js"><link rel="prefetch" href="/assets/js/46.5762f1d8.js"><link rel="prefetch" href="/assets/js/47.71e23426.js"><link rel="prefetch" href="/assets/js/48.95d09945.js"><link rel="prefetch" href="/assets/js/49.e86f75cc.js"><link rel="prefetch" href="/assets/js/5.f72b9a19.js"><link rel="prefetch" href="/assets/js/50.d8548f6b.js"><link rel="prefetch" href="/assets/js/51.b0a7ddfe.js"><link rel="prefetch" href="/assets/js/52.4b63c945.js"><link rel="prefetch" href="/assets/js/53.59e69768.js"><link rel="prefetch" href="/assets/js/54.0fa4079f.js"><link rel="prefetch" href="/assets/js/55.32bea307.js"><link rel="prefetch" href="/assets/js/6.d9031ffc.js"><link rel="prefetch" href="/assets/js/7.739ee4af.js"><link rel="prefetch" href="/assets/js/8.79012347.js"><link rel="prefetch" href="/assets/js/9.7bcfb182.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56c699db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小杨--个人笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>React</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/react/react.html" class="sidebar-link">React基础</a></li><li><a href="/react/install.html" class="sidebar-link">项目搭建</a></li><li><a href="/react/base.html" class="sidebar-link">基础知识</a></li><li><a href="/react/newreact.html" class="sidebar-link">React 16.x</a></li><li><a href="/react/reactrouter.html" class="sidebar-link">React Router</a></li><li><a href="/react/redux.html" class="sidebar-link">Redux 基础</a></li><li><a href="/react/rhooks.html" class="sidebar-link">React Hooks</a></li><li><a href="/react/umi.html" class="sidebar-link">UmiJS</a></li><li><a href="/react/next.html" class="sidebar-link">Next</a></li><li><a href="/react/demo.html" class="active sidebar-link">经典案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/demo.html#fetch上传文件" class="sidebar-link">fetch上传文件</a></li><li class="sidebar-sub-header"><a href="/react/demo.html#xlsx应用" class="sidebar-link">xlsx应用</a></li><li class="sidebar-sub-header"><a href="/react/demo.html#file-saver" class="sidebar-link">File-saver</a></li><li class="sidebar-sub-header"><a href="/react/demo.html#csv文件导出" class="sidebar-link">csv文件导出</a></li><li class="sidebar-sub-header"><a href="/react/demo.html#百度地图" class="sidebar-link">百度地图</a></li><li class="sidebar-sub-header"><a href="/react/demo.html#处理多个输入" class="sidebar-link">处理多个输入</a></li></ul></li><li><a href="/react/rnative.html" class="sidebar-link">React Native</a></li><li><a href="/react/taro.html" class="sidebar-link">Taro多端开发</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="经典案例"><a href="#经典案例" class="header-anchor">#</a> 经典案例</h1> <h2 id="fetch上传文件"><a href="#fetch上传文件" class="header-anchor">#</a> fetch上传文件</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// services.js</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/v1/template/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    methods<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    body<span class="token operator">:</span> params<span class="token punctuation">.</span>formData <span class="token comment">// body不允许传对象</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>页面触发</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">upload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token comment">// template_name 为传的字段名字，file.name 为传的字段名所对应的值</span>
  formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'template_name'</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可以通过formData.append增加多个字段名、值</span>
  formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'template_file'</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">uploadFile</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> resData <span class="token operator">=</span> res<span class="token punctuation">.</span>json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="xlsx应用"><a href="#xlsx应用" class="header-anchor">#</a> xlsx应用</h2> <blockquote><p>读取excel表格文件的全部内容或者读取某个文件某个单元格的内容，将其渲染</p></blockquote> <p>参考文档:<br> <a href="https://www.npmjs.com/package/xlsx" target="_blank" rel="noopener noreferrer">npm xlsx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://blog.csdn.net/qq_42564846/article/details/83068863" target="_blank" rel="noopener noreferrer">xlsx 插件用法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 安装依赖</span>
npm install xlsx 
<span class="token comment">// 在项目中引入</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">'xlsx'</span><span class="token punctuation">;</span> 
<span class="token comment">// 定义上传 input，accept 属性定义了上传文件支持的类型，onChange 操作中的 importExcel 方法定义了上传文件时执行的操作。</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">'file'</span> accept<span class="token operator">=</span><span class="token string">'.xlsx, .xls'</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onImportExcel<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 
<span class="token comment">// 定义获取和解析 excel 对象的方法</span>
<span class="token function-variable function">onImportExcel</span> <span class="token operator">=</span> <span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取上传的文件对象</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> files <span class="token punctuation">}</span> <span class="token operator">=</span> file<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    <span class="token comment">// 通过FileReader对象读取文件</span>
    <span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> result <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
        <span class="token comment">// 以二进制流方式读取得到整份excel表格对象</span>
        <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'binary'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 存储获取到的数据</span>
        <span class="token comment">// 遍历每张工作表进行读取（这里默认只读取第一张表）</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> sheet <span class="token keyword">in</span> workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// sheet为文件表格内部工作薄名称</span>
            <span class="token comment">// 利用 sheet_to_json 方法将 excel 转成 json 数据</span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span>workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>sheet<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// * 获取工作薄内容</span>
            <span class="token comment">// break; // 如果只取第一张表，就取消注释这行，存在即值取第一张表格</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 这里可以抛出文件类型错误不正确的相关提示</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件类型不正确'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 以二进制方式打开文件</span>
    fileReader<span class="token punctuation">.</span><span class="token function">readAsBinaryString</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">// 取指定工作薄的某个单元格</span>
<span class="token keyword">var</span> first_sheet_name <span class="token operator">=</span> workbook<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取工作薄名称</span>
<span class="token keyword">var</span> address_of_cell <span class="token operator">=</span> <span class="token string">'A1'</span><span class="token punctuation">;</span>
<span class="token comment">/* Get worksheet */</span>
<span class="token keyword">var</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>first_sheet_name<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/* Find desired cell */</span>
<span class="token keyword">var</span> desired_cell <span class="token operator">=</span> worksheet<span class="token punctuation">[</span>address_of_cell<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/* Get the value */</span>
<span class="token keyword">var</span> desired_value <span class="token operator">=</span> <span class="token punctuation">(</span>desired_cell <span class="token operator">?</span> desired_cell<span class="token punctuation">.</span>v <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="file-saver"><a href="#file-saver" class="header-anchor">#</a> File-saver</h2> <blockquote><p>将字符串等字符以json等文件下载下来（注：<strong>此方法仅支持PC端</strong>）</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 安装依赖</span>
npm install file<span class="token operator">-</span>saver <span class="token operator">--</span>save
<span class="token comment">// 页面引入 </span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveAs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'file-saver'</span><span class="token punctuation">;</span>
<span class="token comment">// 使用方法</span>
<span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// data为需要下载的字符串等内容</span>
<span class="token function">saveAs</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fileName为下载文件文件名</span>
<span class="token comment">// ===================== 或者采用以下方法</span>
<span class="token keyword">var</span> eleLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
eleLink<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName<span class="token punctuation">;</span> <span class="token comment">// fileName为文件名</span>
eleLink<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
<span class="token comment">// 字符内容转变成blob地址</span>
<span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// data为下载内容</span>
eleLink<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 触发点击</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>eleLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
eleLink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 然后移除</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>eleLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="csv文件导出"><a href="#csv文件导出" class="header-anchor">#</a> csv文件导出</h2> <blockquote><p>将表格内容以excel表格导出，前端做法</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 下载csv文件</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">'任务导出列表'</span><span class="token punctuation">;</span> <span class="token comment">// name为文件名</span>
<span class="token keyword">var</span> uri <span class="token operator">=</span> <span class="token string">'data:text/csv;charset=utf-8,\ufeff'</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// content为文件内容，字段与字段之间用“,”隔开，换行用“\n”隔开，拼接而成的字符串</span>
<span class="token keyword">var</span> downloadLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
downloadLink<span class="token punctuation">.</span>href <span class="token operator">=</span> uri<span class="token punctuation">;</span>
downloadLink<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">&quot;.csv&quot;</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">&quot;temp.csv&quot;</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>downloadLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
downloadLink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>downloadLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="百度地图"><a href="#百度地图" class="header-anchor">#</a> 百度地图</h2> <p>参考文档:<br> <a href="http://lbsyun.baidu.com/" target="_blank" rel="noopener noreferrer">百度地图 官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入百度地图api，ak后面的需要自己申请</span>
<span class="token operator">-</span><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;http://api.map.baidu.com/api?v=3.0&amp;ak=OXAZTgatVu8n0iVGUj3H8udtCg7Dw0bW&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// 在webpack.config.dev.js增加如下代码：</span>
externals<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">'BMap'</span><span class="token operator">:</span> <span class="token string">'BMap'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 页面书写如下代码</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> BMap <span class="token keyword">from</span> <span class="token string">'BMap'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>getProject<span class="token punctuation">,</span> management<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../services/systems&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> iconGreen <span class="token keyword">from</span> <span class="token string">'../../assets/images/popGreen.png'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> noImg <span class="token keyword">from</span> <span class="token string">'../../assets/images/tup.png'</span><span class="token punctuation">;</span> <span class="token comment">// 无图显示</span>

<span class="token keyword">class</span> <span class="token class-name">MapBd</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>curId <span class="token operator">=</span> props<span class="token punctuation">.</span>curId<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>circles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>removeId <span class="token operator">=</span> props<span class="token punctuation">.</span>removeId<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>runMapFunc <span class="token operator">=</span> props<span class="token punctuation">.</span>runMapFunc<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isChoose <span class="token operator">=</span> props<span class="token punctuation">.</span>isChoose<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>telnetMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customerMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>assetPicMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化地图</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span>map2DData<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span>map2DData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function-variable function">initMap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>enableMapClick<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建地图实例  </span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">104.074056</span><span class="token punctuation">,</span><span class="token number">30.657563</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建点坐标  </span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">centerAndZoom</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化地图，设置中心点坐标和地图级别 </span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">enableScrollWheelZoom</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//开启鼠标滚轮缩放</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">BMAP_ANCHOR_BOTTOM_RIGHT</span><span class="token punctuation">,</span> <span class="token constant">BMAP_NORMAL_MAP</span><span class="token punctuation">,</span> <span class="token constant">BMAP_SATELLITE_MAP</span><span class="token punctuation">,</span> <span class="token constant">BMAP_HYBRID_MAP</span> <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">;</span> <span class="token comment">// window里面包含了很多参数，解决这些参数未定义问题</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>NavigationControl</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// type : BMAP_NAVIGATION_CONTROL_ZOOM, //缩放控件类型 仅包含缩放按钮</span>
      anchor <span class="token operator">:</span> <span class="token constant">BMAP_ANCHOR_BOTTOM_RIGHT</span><span class="token punctuation">,</span> <span class="token comment">// 右下角</span>
      offset <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//进一步控制缩放按钮的水平竖直偏移量</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 左上角控件  </span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>ScaleControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 左下角标尺控件</span>
    <span class="token comment">// map.addControl(new BMap.OverviewMapControl()); //</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>MapTypeControl</span><span class="token punctuation">(</span><span class="token punctuation">{</span>mapTypes<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token constant">BMAP_NORMAL_MAP</span><span class="token punctuation">,</span> <span class="token constant">BMAP_SATELLITE_MAP</span><span class="token punctuation">,</span> <span class="token constant">BMAP_HYBRID_MAP</span> <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 地图控件、卫星控件、混合控件</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">addMarker</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">markerList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 将坐标点逐个渲染到页面上</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token constant">BMAP_ANIMATION_BOUNCE</span> <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">;</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> pointArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>markerList<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> item <span class="token operator">=</span> markerList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> strv <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>strv1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      pointArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span>strv<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> strv<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> markerIcon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Icon</span><span class="token punctuation">(</span>iconGreen<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> steelMarker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span>pointArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>icon<span class="token operator">:</span> markerIcon<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建标注</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addOverlay</span><span class="token punctuation">(</span>steelMarker<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 地图中增加点</span>
      steelMarker<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseover&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 鼠标滑过事件mouseover</span>
          <span class="token comment">// this.openInfoWindow(e.target.infoWindow); // 弹出信息窗口</span>
          that<span class="token punctuation">.</span><span class="token function">addInfo</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      steelMarker<span class="token punctuation">.</span><span class="token function">closeInfoWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// closeInfoWindow关闭信息窗口</span>
      <span class="token comment">// steelMarker.addEventListener(&quot;mouseout&quot;,function () { // 鼠标移开事件mouseout</span>
      <span class="token comment">//   this.closeInfoWindow();</span>
      <span class="token comment">// });</span>

      steelMarker<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> key <span class="token operator">=</span> item<span class="token punctuation">.</span>entityId<span class="token punctuation">;</span>
        <span class="token keyword">let</span> name <span class="token operator">=</span> strv<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
        that<span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">setCurAssetName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        that<span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">openTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token operator">:</span> key<span class="token punctuation">,</span> name<span class="token operator">:</span> name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        that<span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">modifyLayer</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        that<span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">modifyWorkBtn</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置选中的点上下抖动</span>
        <span class="token keyword">var</span> allOverlay <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getOverlays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取所有标注点</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> allOverlay<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          allOverlay<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清除跳动动画</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>allOverlay<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">.</span>lat <span class="token operator">==</span> strv<span class="token punctuation">.</span>latitude <span class="token operator">&amp;&amp;</span> allOverlay<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">.</span>lng <span class="token operator">==</span> strv<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">{</span>
            allOverlay<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setAnimation</span><span class="token punctuation">(</span><span class="token constant">BMAP_ANIMATION_BOUNCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//为当前点添加跳动动画</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">addInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> strv <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>strv1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> allOverlay <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getOverlays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取所有标注点</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> newData <span class="token operator">=</span> allOverlay<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span> <span class="token parameter">i</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span>point<span class="token punctuation">.</span>lat <span class="token operator">==</span> strv<span class="token punctuation">.</span>latitude <span class="token operator">&amp;&amp;</span> i<span class="token punctuation">.</span>point<span class="token punctuation">.</span>lng <span class="token operator">==</span> strv<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">getAssetAttr</span><span class="token punctuation">(</span><span class="token punctuation">{</span>assetId<span class="token operator">:</span> item<span class="token punctuation">.</span>entityId<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> picImg <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>generalInfo<span class="token punctuation">.</span>facilitiesPic1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        picImg <span class="token operator">=</span> res<span class="token punctuation">.</span>generalInfo<span class="token punctuation">.</span>facilitiesPic1<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>generalInfo<span class="token punctuation">.</span>facilitiesPic2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        picImg <span class="token operator">=</span> res<span class="token punctuation">.</span>generalInfo<span class="token punctuation">.</span>facilitiesPic2<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        picImg <span class="token operator">=</span> noImg<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      that<span class="token punctuation">.</span>assetPicMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>entityId<span class="token punctuation">,</span> picImg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> _img <span class="token operator">=</span> that<span class="token punctuation">.</span>assetPicMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>entityId<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> tenant <span class="token operator">=</span> that<span class="token punctuation">.</span>telnetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>strv<span class="token punctuation">.</span>tenantIdStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> customer <span class="token operator">=</span> that<span class="token punctuation">.</span>customerMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>strv<span class="token punctuation">.</span>customerIdStr<span class="token punctuation">)</span>
      <span class="token keyword">let</span> steelContent <span class="token operator">=</span> <span class="token string">'&lt;div&gt;'</span><span class="token operator">+</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;img src='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>_img<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' style='width:240px;height:124px'&gt;</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
        <span class="token string">&quot;&lt;table style='border:1px solid;width: 240px;height:60px;margin-top:10px'&gt;&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;&lt;tr style='border-bottom: 1px solid'&gt;&quot;</span> <span class="token operator">+</span>
        <span class="token string">&quot;&lt;td style='border-right: 1px solid;padding-left:10px;width: 80px'&gt;所属项目&lt;/td&gt;&lt;td style='padding-left:10px'&gt;&quot;</span><span class="token operator">+</span>tenant<span class="token operator">+</span><span class="token string">&quot;&lt;/td&gt;&quot;</span>
        <span class="token operator">+</span> <span class="token string">'&lt;/tr&gt;'</span> <span class="token operator">+</span>
        <span class="token string">'&lt;tr&gt;'</span> <span class="token operator">+</span> 
        <span class="token string">&quot;&lt;td style='border-right: 1px solid;padding-left:10px;width: 80px'&gt;所属项目&lt;/td&gt;&lt;td style='padding-left:10px'&gt;&quot;</span><span class="token operator">+</span>customer<span class="token operator">+</span><span class="token string">&quot;&lt;/td&gt;&quot;</span>
        <span class="token operator">+</span> <span class="token string">'&lt;/tr&gt;'</span> <span class="token operator">+</span>
        <span class="token string">'&lt;/table&gt;'</span> <span class="token operator">+</span>
        <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> steelOpts <span class="token operator">=</span> <span class="token punctuation">{</span>
          width <span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>     <span class="token comment">//信息窗口宽度</span>
          height<span class="token operator">:</span> <span class="token number">230</span><span class="token punctuation">,</span>     <span class="token comment">//信息窗口高度</span>
          title <span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token comment">//信息窗口标题</span>
          offset<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 信息框向上偏移，解决信息框闪烁问题</span>
          enableMessage<span class="token operator">:</span><span class="token boolean">true</span>	<span class="token comment">//设置允许信息窗发送短息</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> infoWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BMap<span class="token punctuation">.</span>InfoWindow</span><span class="token punctuation">(</span>steelContent<span class="token punctuation">,</span> steelOpts<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建信息窗口</span>
        newData<span class="token punctuation">.</span>infoWindow <span class="token operator">=</span> infoWindow<span class="token punctuation">;</span>
        newData<span class="token punctuation">.</span><span class="token function">openInfoWindow</span><span class="token punctuation">(</span>newData<span class="token punctuation">.</span>infoWindow<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;container&quot;</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="处理多个输入"><a href="#处理多个输入" class="header-anchor">#</a> 处理多个输入</h2> <blockquote><p>当需要处理多个 input 元素时，我们可以给每个元素添加 name 属性，并让处理函数根据 event.target.name 的值选择要执行的操作。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例如：</span>
<span class="token keyword">class</span> <span class="token class-name">Reservation</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      isGoing<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      numberOfGuests<span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>handleInputChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleInputChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">handleInputChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> target<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'checkbox'</span> <span class="token operator">?</span> target<span class="token punctuation">.</span>checked <span class="token operator">:</span> target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> target<span class="token punctuation">.</span>name<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token operator">:</span> value
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>form<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>
          参与<span class="token operator">:</span>
          <span class="token operator">&lt;</span>input
            name<span class="token operator">=</span><span class="token string">&quot;isGoing&quot;</span>
            type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span>
            checked<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isGoing<span class="token punctuation">}</span>
            onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleInputChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>
          来宾人数<span class="token operator">:</span>
          <span class="token operator">&lt;</span>input
            name<span class="token operator">=</span><span class="token string">&quot;numberOfGuests&quot;</span>
            type<span class="token operator">=</span><span class="token string">&quot;number&quot;</span>
            value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numberOfGuests<span class="token punctuation">}</span>
            onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleInputChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react/next.html" class="prev">
          Next
        </a></span> <span class="next"><a href="/react/rnative.html">
          React Native
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.af8c451a.js" defer></script><script src="/assets/js/34.00f8c821.js" defer></script>
  </body>
</html>
