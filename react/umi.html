<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>UmiJS | 小杨--个人笔记</title>
    <meta name="description" content="详情描述">
    <link rel="icon" href="/iamges/favicons.ico">
    
    <link rel="preload" href="/assets/css/0.styles.56c699db.css" as="style"><link rel="preload" href="/assets/js/app.af8c451a.js" as="script"><link rel="preload" href="/assets/js/37.edb9b8b9.js" as="script"><link rel="prefetch" href="/assets/js/10.f9ce7cc1.js"><link rel="prefetch" href="/assets/js/11.dffd68cf.js"><link rel="prefetch" href="/assets/js/12.88b968c3.js"><link rel="prefetch" href="/assets/js/13.ee021609.js"><link rel="prefetch" href="/assets/js/14.0d9da61d.js"><link rel="prefetch" href="/assets/js/15.cf7a716a.js"><link rel="prefetch" href="/assets/js/16.68eea69c.js"><link rel="prefetch" href="/assets/js/17.9c9ed280.js"><link rel="prefetch" href="/assets/js/18.3fd6d31e.js"><link rel="prefetch" href="/assets/js/19.d2c7fa8e.js"><link rel="prefetch" href="/assets/js/2.c36408f4.js"><link rel="prefetch" href="/assets/js/20.ad9fa36b.js"><link rel="prefetch" href="/assets/js/21.3829d637.js"><link rel="prefetch" href="/assets/js/22.6294a8c2.js"><link rel="prefetch" href="/assets/js/23.16fcadda.js"><link rel="prefetch" href="/assets/js/24.9f3982d3.js"><link rel="prefetch" href="/assets/js/25.cdd1e6a9.js"><link rel="prefetch" href="/assets/js/26.18563480.js"><link rel="prefetch" href="/assets/js/27.4705311f.js"><link rel="prefetch" href="/assets/js/28.09fcc8b4.js"><link rel="prefetch" href="/assets/js/29.44f1703f.js"><link rel="prefetch" href="/assets/js/3.b8072446.js"><link rel="prefetch" href="/assets/js/30.adbb594e.js"><link rel="prefetch" href="/assets/js/31.00599d01.js"><link rel="prefetch" href="/assets/js/32.61ba3371.js"><link rel="prefetch" href="/assets/js/33.8420b93c.js"><link rel="prefetch" href="/assets/js/34.00f8c821.js"><link rel="prefetch" href="/assets/js/35.1141f38d.js"><link rel="prefetch" href="/assets/js/36.366705ba.js"><link rel="prefetch" href="/assets/js/38.b440a287.js"><link rel="prefetch" href="/assets/js/39.e9b1aaa4.js"><link rel="prefetch" href="/assets/js/4.1c4d5fc0.js"><link rel="prefetch" href="/assets/js/40.16da07a5.js"><link rel="prefetch" href="/assets/js/41.350c3c58.js"><link rel="prefetch" href="/assets/js/42.ab0911d4.js"><link rel="prefetch" href="/assets/js/43.994d22b7.js"><link rel="prefetch" href="/assets/js/44.48fc8e1b.js"><link rel="prefetch" href="/assets/js/45.29742ea8.js"><link rel="prefetch" href="/assets/js/46.5762f1d8.js"><link rel="prefetch" href="/assets/js/47.71e23426.js"><link rel="prefetch" href="/assets/js/48.95d09945.js"><link rel="prefetch" href="/assets/js/49.e86f75cc.js"><link rel="prefetch" href="/assets/js/5.f72b9a19.js"><link rel="prefetch" href="/assets/js/50.d8548f6b.js"><link rel="prefetch" href="/assets/js/51.b0a7ddfe.js"><link rel="prefetch" href="/assets/js/52.4b63c945.js"><link rel="prefetch" href="/assets/js/53.59e69768.js"><link rel="prefetch" href="/assets/js/54.0fa4079f.js"><link rel="prefetch" href="/assets/js/55.32bea307.js"><link rel="prefetch" href="/assets/js/6.d9031ffc.js"><link rel="prefetch" href="/assets/js/7.739ee4af.js"><link rel="prefetch" href="/assets/js/8.79012347.js"><link rel="prefetch" href="/assets/js/9.7bcfb182.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56c699db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小杨--个人笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>React</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/react/react.html" class="sidebar-link">React基础</a></li><li><a href="/react/install.html" class="sidebar-link">项目搭建</a></li><li><a href="/react/base.html" class="sidebar-link">基础知识</a></li><li><a href="/react/newreact.html" class="sidebar-link">React 16.x</a></li><li><a href="/react/reactrouter.html" class="sidebar-link">React Router</a></li><li><a href="/react/redux.html" class="sidebar-link">Redux 基础</a></li><li><a href="/react/rhooks.html" class="sidebar-link">React Hooks</a></li><li><a href="/react/umi.html" class="active sidebar-link">UmiJS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/umi.html#目录及约定" class="sidebar-link">目录及约定</a></li><li class="sidebar-sub-header"><a href="/react/umi.html#约定式路由" class="sidebar-link">约定式路由</a></li><li class="sidebar-sub-header"><a href="/react/umi.html#配置式路由" class="sidebar-link">配置式路由</a></li><li class="sidebar-sub-header"><a href="/react/umi.html#启用-hash-路由" class="sidebar-link">启用 Hash 路由</a></li><li class="sidebar-sub-header"><a href="/react/umi.html#页面间跳转" class="sidebar-link">页面间跳转</a></li><li class="sidebar-sub-header"><a href="/react/umi.html#html-模板" class="sidebar-link">HTML 模板</a></li></ul></li><li><a href="/react/next.html" class="sidebar-link">Next</a></li><li><a href="/react/demo.html" class="sidebar-link">经典案例</a></li><li><a href="/react/rnative.html" class="sidebar-link">React Native</a></li><li><a href="/react/taro.html" class="sidebar-link">Taro多端开发</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="umijs"><a href="#umijs" class="header-anchor">#</a> UmiJS</h1> <blockquote><p>该部分笔记摘抄于<a href="https://umijs.org/zh/" target="_blank" rel="noopener noreferrer">UmiJS官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，记录其中常用部分，其余具体请查阅官网。</p></blockquote> <p>umi，中文可发音为乌米，是一个可插拔的企业级 react 应用框架。umi 以路由为基础的，支持类 next.js 的约定式路由，以及各种进阶的路由功能，并以此进行功能扩展，比如支持路由级的按需加载。然后配以完善的插件体系，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求，目前内外部加起来已有 50+ 的插件。</p> <p>umi 是蚂蚁金服的底层前端框架，已直接或间接地服务了 600+ 应用，包括 java、node、H5 无线、离线（Hybrid）应用、纯前端 assets 应用、CMS 应用等。他已经很好地服务了我们的内部用户，同时希望他也能服务好外部用户。</p> <p>特性</p> <div class="language-sh extra-class"><pre class="language-text"><code>📦 开箱即用，内置 react、react-router 等  
🏈 类 next.js 且功能完备的路由约定，同时支持配置的路由方式  
🎉 完善的插件体系，覆盖从源码到构建产物的每个生命周期  
🚀 高性能，通过插件支持 PWA、以路由为单元的 code splitting 等  
💈 支持静态页面导出，适配各种环境，比如中台业务、无线业务、egg、支付宝钱包、云凤蝶等  
🚄 开发启动快，支持一键开启 dll 等  
🐠 一键兼容到 IE9，基于 umi-plugin-polyfills  
🍁 完善的 TypeScript 支持，包括 d.ts 定义和 umi test  
🌴 与 dva 数据流的深入融合，支持 duck directory、model 的自动加载、code splitting 等等
</code></pre></div><h2 id="目录及约定"><a href="#目录及约定" class="header-anchor">#</a> 目录及约定</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">.</span>
├── dist<span class="token operator">/</span>                          <span class="token comment">// 默认的 build 输出目录</span>
├── mock<span class="token operator">/</span>                          <span class="token comment">// mock 文件所在目录，基于 express</span>
├── config<span class="token operator">/</span>
    ├── config<span class="token punctuation">.</span>js                  <span class="token comment">// umi 配置，同 .umirc.js，二选一</span>
└── src<span class="token operator">/</span>                           <span class="token comment">// 源码目录，可选</span>
    ├── layouts<span class="token operator">/</span>index<span class="token punctuation">.</span>js           <span class="token comment">// 全局布局</span>
    ├── pages<span class="token operator">/</span>                     <span class="token comment">// 页面目录，里面的文件即路由</span>
        ├── <span class="token punctuation">.</span>umi<span class="token operator">/</span>                  <span class="token comment">// dev 临时目录，需添加到 .gitignore</span>
        ├── <span class="token punctuation">.</span>umi<span class="token operator">-</span>production<span class="token operator">/</span>       <span class="token comment">// build 临时目录，会自动删除</span>
        ├── document<span class="token punctuation">.</span>ejs           <span class="token comment">// HTML 模板</span>
        ├── <span class="token number">404.</span>js                 <span class="token comment">// 404 页面</span>
        ├── page1<span class="token punctuation">.</span>js               <span class="token comment">// 页面 1，任意命名，导出 react 组件</span>
        ├── page1<span class="token punctuation">.</span>test<span class="token punctuation">.</span>js          <span class="token comment">// 用例文件，umi test 会匹配所有 .test.js 和 .e2e.js 结尾的文件</span>
        └── page2<span class="token punctuation">.</span>js               <span class="token comment">// 页面 2，任意命名</span>
    ├── global<span class="token punctuation">.</span>css                 <span class="token comment">// 约定的全局样式文件，自动引入，也可以用 global.less</span>
    ├── global<span class="token punctuation">.</span>js                  <span class="token comment">// 可以在这里加入 polyfill</span>
    ├── app<span class="token punctuation">.</span>js                     <span class="token comment">// 运行时配置文件</span>
├── <span class="token punctuation">.</span>umirc<span class="token punctuation">.</span>js                      <span class="token comment">// umi 配置，同 config/config.js，二选一</span>
├── <span class="token punctuation">.</span>env                           <span class="token comment">// 环境变量</span>
└── <span class="token keyword">package</span><span class="token punctuation">.</span>json
</code></pre></div><h3 id="mock"><a href="#mock" class="header-anchor">#</a> mock</h3> <p>此目录下所有的 .js 文件（包括 _ 前缀的）都会被解析为 mock 文件。</p> <p>比如，新建 mock/users.js，内容如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token string">'/api/users'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>然后在浏览器里访问 http://localhost:8000/api/users 就可以看到 ['a', 'b'] 了。</p> <p>如果想忽略 mock 文件夹下的部分文件，排除 mock 目录下不作 mock 处理的文件，则在.umirc.js或config/config.js中进行配置，如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  mock<span class="token operator">:</span> <span class="token punctuation">{</span>
    exclude<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'mock/**/_*.js'</span><span class="token punctuation">,</span> <span class="token string">'mock/_*/**/*.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="src-layouts-index-js"><a href="#src-layouts-index-js" class="header-anchor">#</a> src/layouts/index.js</h3> <p>注：配置式路由下无效。</p> <p>全局布局，在路由外面套的一层路由。</p> <p>比如，你的路由是：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/index'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/users'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>如果有 layouts/index.js，那么路由就会变为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span><span class="token string">'./layouts/index'</span><span class="token punctuation">,</span>
    routes<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/index'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/users'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="src-pages-umi"><a href="#src-pages-umi" class="header-anchor">#</a> src/pages/.umi</h3> <p>这是 umi dev 时生产的临时目录，默认包含 umi.js 和 router.js，有些插件也会在这里生成一些其他临时文件。可以在这里做一些验证，但请不要直接在这里修改代码，umi 重启或者 pages 下的文件修改都会重新生成这个文件夹下的文件。</p> <h3 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h3> <p>.umirc.(js|ts) 和 config/config.(js|ts) 编译时配置文件，二选一，不可共存。</p> <h3 id="env"><a href="#env" class="header-anchor">#</a> .env</h3> <p>环境变量配置文件，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">CLEAR_CONSOLE</span><span class="token operator">=</span>none
<span class="token constant">BROWSER</span><span class="token operator">=</span>none <span class="token comment">// 删除该行，启动项目时会打开默认浏览器</span>
</code></pre></div><p>这里定义的系统环境变量在整个umi-build-dev的生命周期里都可以被使用</p> <h2 id="约定式路由"><a href="#约定式路由" class="header-anchor">#</a> 约定式路由</h2> <p>假设 pages 目录结构如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">+</span> pages<span class="token operator">/</span>
  <span class="token operator">+</span> users<span class="token operator">/</span>
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
    <span class="token operator">-</span> list<span class="token punctuation">.</span>js
  <span class="token operator">-</span> index<span class="token punctuation">.</span>js
</code></pre></div><p>那么，umi 会自动生成路由配置如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/index.js'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/users/index.js'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users/list'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./pages/users/list.js'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">注意</p> <p>若 .umirc.(ts|js) 或 config/config.(ts|js) 文件中对 router 进行了配置，约定式路由将失效、新添的页面不会自动被 umi 编译，umi 将使用配置式路由。(即文件中不能包含routes属性)</p></div> <h2 id="配置式路由"><a href="#配置式路由" class="header-anchor">#</a> 配置式路由</h2> <p>如果你倾向于使用配置式的路由，可以配置 .umirc.(ts|js) 或者 config/config.(ts|js) 配置文件中的 routes 属性，<strong>此配置项存在时则不会对 src/pages 目录做约定式的解析。</strong></p> <p>比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./a'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./b'</span><span class="token punctuation">,</span> Routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./routes/PrivateRoute.js'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./users/_layout'</span><span class="token punctuation">,</span>
      routes<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users/detail'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./users/detail'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/users/:id'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> <span class="token string">'./users/id'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：<strong>component 是相对于 src/pages 目录的</strong></p> <h2 id="启用-hash-路由"><a href="#启用-hash-路由" class="header-anchor">#</a> 启用 Hash 路由</h2> <p><strong>umi 默认是用的 Browser History</strong>，如果要用 Hash History，需配置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token string">'hash'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="页面间跳转"><a href="#页面间跳转" class="header-anchor">#</a> 页面间跳转</h2> <p>在 umi 里，页面之间跳转有两种方式：声明式和命令式。</p> <h3 id="声明式"><a href="#声明式" class="header-anchor">#</a> 声明式</h3> <p>基于 umi/link，通常作为 React 组件使用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'umi/link'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/list&quot;</span><span class="token operator">&gt;</span>Go to list page<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="命令式"><a href="#命令式" class="header-anchor">#</a> 命令式</h3> <p>基于 umi/router，通常在事件处理中被调用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'umi/router'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">goToListPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 命令式路由的传值方式</span>
<span class="token keyword">function</span> <span class="token function">goToHomePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    pathname<span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>
    query<span class="token operator">:</span> <span class="token punctuation">{</span>
        a<span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="router-replace-path"><a href="#router-replace-path" class="header-anchor">#</a> router.replace(path)</h3> <p>替换当前页面，参数和 router.push() 相同。</p> <h3 id="router-go-n"><a href="#router-go-n" class="header-anchor">#</a> router.go(n)</h3> <p>往前或往后跳指定页数。</p> <p>例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'umi/router'</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="router-goback"><a href="#router-goback" class="header-anchor">#</a> router.goBack()</h3> <p>后退一页。</p> <p>例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'umi/router'</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">goBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="html-模板"><a href="#html-模板" class="header-anchor">#</a> HTML 模板</h2> <h3 id="修改默认模板"><a href="#修改默认模板" class="header-anchor">#</a> 修改默认模板</h3> <p>新建 src/pages/document.ejs，umi 约定如果这个文件存在，会作为默认模板，内容上需要保证有 <code>&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code>，比如：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!doctype html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Your App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react/rhooks.html" class="prev">
          React Hooks
        </a></span> <span class="next"><a href="/react/next.html">
          Next
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.af8c451a.js" defer></script><script src="/assets/js/37.edb9b8b9.js" defer></script>
  </body>
</html>
