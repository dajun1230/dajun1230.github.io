<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redux 基础 | 小杨--个人笔记</title>
    <meta name="description" content="详情描述">
    <link rel="icon" href="/iamges/favicons.ico">
    
    <link rel="preload" href="/assets/css/0.styles.56c699db.css" as="style"><link rel="preload" href="/assets/js/app.af8c451a.js" as="script"><link rel="preload" href="/assets/js/11.dffd68cf.js" as="script"><link rel="prefetch" href="/assets/js/10.f9ce7cc1.js"><link rel="prefetch" href="/assets/js/12.88b968c3.js"><link rel="prefetch" href="/assets/js/13.ee021609.js"><link rel="prefetch" href="/assets/js/14.0d9da61d.js"><link rel="prefetch" href="/assets/js/15.cf7a716a.js"><link rel="prefetch" href="/assets/js/16.68eea69c.js"><link rel="prefetch" href="/assets/js/17.9c9ed280.js"><link rel="prefetch" href="/assets/js/18.3fd6d31e.js"><link rel="prefetch" href="/assets/js/19.d2c7fa8e.js"><link rel="prefetch" href="/assets/js/2.c36408f4.js"><link rel="prefetch" href="/assets/js/20.ad9fa36b.js"><link rel="prefetch" href="/assets/js/21.3829d637.js"><link rel="prefetch" href="/assets/js/22.6294a8c2.js"><link rel="prefetch" href="/assets/js/23.16fcadda.js"><link rel="prefetch" href="/assets/js/24.9f3982d3.js"><link rel="prefetch" href="/assets/js/25.cdd1e6a9.js"><link rel="prefetch" href="/assets/js/26.18563480.js"><link rel="prefetch" href="/assets/js/27.4705311f.js"><link rel="prefetch" href="/assets/js/28.09fcc8b4.js"><link rel="prefetch" href="/assets/js/29.44f1703f.js"><link rel="prefetch" href="/assets/js/3.b8072446.js"><link rel="prefetch" href="/assets/js/30.adbb594e.js"><link rel="prefetch" href="/assets/js/31.00599d01.js"><link rel="prefetch" href="/assets/js/32.61ba3371.js"><link rel="prefetch" href="/assets/js/33.8420b93c.js"><link rel="prefetch" href="/assets/js/34.00f8c821.js"><link rel="prefetch" href="/assets/js/35.1141f38d.js"><link rel="prefetch" href="/assets/js/36.366705ba.js"><link rel="prefetch" href="/assets/js/37.edb9b8b9.js"><link rel="prefetch" href="/assets/js/38.b440a287.js"><link rel="prefetch" href="/assets/js/39.e9b1aaa4.js"><link rel="prefetch" href="/assets/js/4.1c4d5fc0.js"><link rel="prefetch" href="/assets/js/40.16da07a5.js"><link rel="prefetch" href="/assets/js/41.350c3c58.js"><link rel="prefetch" href="/assets/js/42.ab0911d4.js"><link rel="prefetch" href="/assets/js/43.994d22b7.js"><link rel="prefetch" href="/assets/js/44.48fc8e1b.js"><link rel="prefetch" href="/assets/js/45.29742ea8.js"><link rel="prefetch" href="/assets/js/46.5762f1d8.js"><link rel="prefetch" href="/assets/js/47.71e23426.js"><link rel="prefetch" href="/assets/js/48.95d09945.js"><link rel="prefetch" href="/assets/js/49.e86f75cc.js"><link rel="prefetch" href="/assets/js/5.f72b9a19.js"><link rel="prefetch" href="/assets/js/50.d8548f6b.js"><link rel="prefetch" href="/assets/js/51.b0a7ddfe.js"><link rel="prefetch" href="/assets/js/52.4b63c945.js"><link rel="prefetch" href="/assets/js/53.59e69768.js"><link rel="prefetch" href="/assets/js/54.0fa4079f.js"><link rel="prefetch" href="/assets/js/55.32bea307.js"><link rel="prefetch" href="/assets/js/6.d9031ffc.js"><link rel="prefetch" href="/assets/js/7.739ee4af.js"><link rel="prefetch" href="/assets/js/8.79012347.js"><link rel="prefetch" href="/assets/js/9.7bcfb182.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56c699db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小杨--个人笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vue/" class="nav-link">Vue</a></div><div class="nav-item"><a href="/react/" class="nav-link router-link-active">React</a></div><div class="nav-item"><a href="/flutter/" class="nav-link">Flutter</a></div><div class="nav-item"><a href="/other/" class="nav-link">其他</a></div><div class="nav-item"><a href="/ps/" class="nav-link">Ps教程</a></div><div class="nav-item"><a href="https://github.com/dajun1230/My_notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>React</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/react/react.html" class="sidebar-link">React基础</a></li><li><a href="/react/install.html" class="sidebar-link">项目搭建</a></li><li><a href="/react/base.html" class="sidebar-link">基础知识</a></li><li><a href="/react/newreact.html" class="sidebar-link">React 16.x</a></li><li><a href="/react/reactrouter.html" class="sidebar-link">React Router</a></li><li><a href="/react/redux.html" class="active sidebar-link">Redux 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/redux.html#redux介绍" class="sidebar-link">Redux介绍</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#ant-design介绍和环境初始化" class="sidebar-link">Ant Design介绍和环境初始化</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#用ant-design制作ui界面" class="sidebar-link">用Ant Design制作UI界面</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#创建redux中的仓库-store和reducer" class="sidebar-link">创建Redux中的仓库-store和reducer</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#redux-dev-tools的安装" class="sidebar-link">Redux Dev Tools的安装</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#通过input体验redux的流程" class="sidebar-link">通过Input体验Redux的流程</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#redux制作todolist列表" class="sidebar-link">Redux制作ToDoList列表</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#用redux实现todolist的删除功能" class="sidebar-link">用Redux实现ToDoList的删除功能</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#工作中写redux的小技巧-1" class="sidebar-link">工作中写Redux的小技巧-1</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#工作中写redux的小技巧-2" class="sidebar-link">工作中写Redux的小技巧-2</a></li><li class="sidebar-sub-header"><a href="/react/redux.html#小结-redux填三个小坑" class="sidebar-link">小结-Redux填三个小坑</a></li></ul></li><li><a href="/react/rhooks.html" class="sidebar-link">React Hooks</a></li><li><a href="/react/umi.html" class="sidebar-link">UmiJS</a></li><li><a href="/react/next.html" class="sidebar-link">Next</a></li><li><a href="/react/demo.html" class="sidebar-link">经典案例</a></li><li><a href="/react/rnative.html" class="sidebar-link">React Native</a></li><li><a href="/react/taro.html" class="sidebar-link">Taro多端开发</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="redux-基础"><a href="#redux-基础" class="header-anchor">#</a> Redux 基础</h1> <h2 id="redux介绍"><a href="#redux介绍" class="header-anchor">#</a> Redux介绍</h2> <p>Redux是一个用来管理管理数据状态和UI状态的JavaScript应用工具。随着JavaScript单页应用（SPA）开发日趋复杂，JavaScript需要管理比任何时候都要多的state（状态），Redux就是降低管理难度的。（Redux支持React，Angular、jQuery甚至纯JavaScript）</p> <h2 id="ant-design介绍和环境初始化"><a href="#ant-design介绍和环境初始化" class="header-anchor">#</a> Ant Design介绍和环境初始化</h2> <ol><li>如果你没有安装脚手架工具，你需要安装一下：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>npm install <span class="token operator">-</span>g create<span class="token operator">-</span>react<span class="token operator">-</span>app
</code></pre></div><ol start="2"><li>直接用脚手架工具创建项目</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">D</span><span class="token operator">:</span>  <span class="token comment">//进入D盘</span>
mkdir ReduxDemo   <span class="token comment">//创建ReduxDemo文件夹</span>
cd ReduxDemo      <span class="token comment">//进入文件夹</span>
create<span class="token operator">-</span>react<span class="token operator">-</span>app demo01  <span class="token comment">//用脚手架创建React项目</span>
cd demo01   <span class="token comment">//等项目创建完成后，进入项目目录</span>
npm  start  <span class="token comment">//预览项目</span>
</code></pre></div><p>这样项目就制作好了，我们删除一下没用的文件，让代码结构保持最小化。删除SRC里边的所有文件，只留一个index.js,并且index.js文件里也都清空。</p> <p><strong>快速生成基本代码结构</strong></p> <p>编写index.js文件,这个文件就是一个基础文件，基本代码也都是一样的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> TodoList <span class="token keyword">from</span> <span class="token string">'./TodoList'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>TodoList<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>编写TodoList.js文件,这个文件可以用Simple React Snippets快速生成。 先输入imrc,再输入ccc，
代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p>做完这个，算是项目基本构建完成，可以打开浏览器看一下效果。接下来就可以安装Ant DesignUI框架了。</p> <p><strong>安装AntDesign</strong></p> <p>这里使用npm来进行安装，当然你有可以用yarn的方式进行安装.</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install antd <span class="token operator">--</span>save
</code></pre></div><p>yarn的安装方式是:</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add antd
</code></pre></div><p>如果你的网络情况不好，最好使用cnpm来进行安装。</p> <h2 id="用ant-design制作ui界面"><a href="#用ant-design制作ui界面" class="header-anchor">#</a> 用Ant Design制作UI界面</h2> <p><strong>引入CSS样式</strong></p> <p>在使用Ant Design时，第一件事就是先引入CSS样式，有了样式才可以让UI组件显示正常。可以直接在/src/TodoList.js文件中直接用import引入。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>编写Input框</strong></p> <p>引入CSS样式之后，可以快乐的使用antd里的input框了，在使用的时候，你需要先引入Input组件。全部代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Input placeholder<span class="token operator">=</span><span class="token string">'Write something'</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p>在Input组件里，我们设置了style，注意设置这个时不带单引号或者双引号的。</p> <p>写完后就可以简单的看一下效果了。</p> <p><strong>编写Button按钮</strong></p> <p>Ant Design也提供了丰富好看的按钮组件，直接使用最简单的Primary按钮。使用按钮组件前也需要先引入,为了让组件更好看，还加入了一些Margin样式，代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Input placeholder<span class="token operator">=</span><span class="token string">'Write something'</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p><strong>List组件制作列表</strong></p> <p>同样用Ant Desgin制作todoList的列表，在制作前，我们先在class外部声明一个data数组，数组内容可以随便写。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> data<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token string">'早8点开晨会，分配今天的开发工作'</span><span class="token punctuation">,</span>
    <span class="token string">'早9点和项目经理作开发需求讨论会'</span><span class="token punctuation">,</span>
    <span class="token string">'晚5:30对今日代码进行review'</span>
<span class="token punctuation">]</span>
</code></pre></div><p>然后引入List组件，代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">,</span> List <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>
</code></pre></div><p>最后就是使用这个List组件了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>List
        bordered
        dataSource<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">}</span>
        renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>    
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>为了方便学习，我给出了全部代码，如果你作起来有难度，可以直接复制下面的代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">,</span> List <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>

<span class="token keyword">const</span> data<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token string">'早8点开晨会，分配今天的开发工作'</span><span class="token punctuation">,</span>
    <span class="token string">'早9点和项目经理作开发需求讨论会'</span><span class="token punctuation">,</span>
    <span class="token string">'晚5:30对今日代码进行review'</span>
<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Input placeholder<span class="token operator">=</span><span class="token string">'write someting'</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>List
                        bordered
                        dataSource<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">}</span>
                        renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                    <span class="token operator">/</span><span class="token operator">&gt;</span>    
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><h2 id="创建redux中的仓库-store和reducer"><a href="#创建redux中的仓库-store和reducer" class="header-anchor">#</a> 创建Redux中的仓库-store和reducer</h2> <p><strong>编写创建store仓库</strong></p> <p>在使用Redux之前，需要先用npm install来进行安装,打开终端，并进入到项目目录，然后输入。（如果你之前安装过了，就不用再次安装了）</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install <span class="token operator">--</span>save redux <span class="token comment">// 生产环境安装redux</span>
</code></pre></div><p>安装好redux之后，在src目录下创建一个store文件夹,然后在文件夹下创建一个index.js文件。</p> <p>index.js就是整个项目的store文件，打开文件，编写下面的代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>   <span class="token comment">// 引入createStore方法</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 创建数据存储仓库</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>                 <span class="token comment">//暴露出去</span>
</code></pre></div><p>这样虽然已经建立好了仓库，但是这个仓库很混乱，这时候就需要一个有管理能力的模块出现，这就是Reducers。这两个一定要一起创建出来，这样仓库才不会出现互怼现象。在store文件夹下，新建一个文件reducer.js,然后写入下面的代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//默认数据</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>  <span class="token comment">//就是一个方法函数</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>**state:**是整个项目中需要管理的数据信息,这里我们没有什么数据，所以用空对象来表示。
这样reducer就建立好了，把reducer引入到store中,再创建store时，以参数的形式传递给store。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>  <span class="token comment">//  引入createStore方法</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducer'</span>    
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span> <span class="token comment">// 创建数据存储仓库</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store   <span class="token comment">//暴露出去</span>
</code></pre></div><p><strong>在store中为todoList初始化数据</strong></p> <p>仓库store和reducer都创建好了，可以初始化一下todoList中的数据了，在reducer.js文件的defaultState对象中，加入两个属性:inputValue和list。代码如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
    inputValue <span class="token operator">:</span> <span class="token string">'Write Something'</span><span class="token punctuation">,</span>
    list<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">'早8点开晨会，分配今天的开发工作'</span><span class="token punctuation">,</span>
        <span class="token string">'早9点和项目经理作开发需求'</span><span class="token punctuation">,</span>
        <span class="token string">'晚5.30对今日代码进行review'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这就相当于你给Store里增加了两个新的数据。</p> <p><strong>组件获得store中的数据</strong></p> <p>有了store仓库，也有了数据，那如何获得stroe中的数据那？你可以在要使用的组件中，先引入store。 我们todoList组件要使用store，就在src/TodoList.js文件夹中，进行引入。这时候可以删除以前写的data数据了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store/index'</span>
</code></pre></div><p>当然你也可以简写成这样:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>
</code></pre></div><p>引入store后可以试着在构造方法里打印到控制台一下，看看是否真正获得了数据，如果一切正常，是完全可以获取数据的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// store.getState()为获取store中defaultState的值</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候数据还不能在UI层让组件直接使用，我们可以直接复制给组件的state，代码如下(我这里为了方便学习，给出全部代码了).</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">,</span> List <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token comment">//关键代码-----------start</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//关键代码-----------end</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                    
                    <span class="token operator">&lt;</span>Input placeholder<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>List
                        bordered
                        <span class="token comment">//关键代码-----------start</span>
                        dataSource<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span>
                        <span class="token comment">//关键代码-----------end</span>
                        renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                    <span class="token operator">/</span><span class="token operator">&gt;</span>    
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p>通过上面的步骤，我们从仓库里取出了数据，并用在组件的UI界面上，也算是一个小小的进步了。</p> <h2 id="redux-dev-tools的安装"><a href="#redux-dev-tools的安装" class="header-anchor">#</a> Redux Dev Tools的安装</h2> <blockquote><p>安装此工具需要科学上网。</p></blockquote> <p><strong>安装Redux DevTools</strong></p> <p>我使用Chrome浏览器安装插件，在浏览器右上角有三个点，然后点击&quot;更多工具&quot;,再点击&quot;扩展程序&quot;，再点击右侧的&quot;打开Chrome网上商店&quot;,然后搜索Redux DevTools，可以看到下面这个插件，直接安装就可以了。</p> <p><img src="/assets/img/Redux_tools.0d912f9e.png" alt="An image"></p> <p>安装完成后，你在控制台中就可以看到Redux标签了，有了这个标签也说明安装成功了。</p> <p><strong>配置Redux Dev Tools</strong></p> <p>如何配置这个Redux Dev Tools插件? 其实在(Redux Dev Tools网站)[https://github.com/zalmoxisus/redux-devtools-extension]上已经说的非常清楚了，现在通过插件，打开这个网站。根据网站提示，可以将index.js代码改为下面的样子。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>  <span class="token comment">//  引入createStore方法</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
  reducer<span class="token punctuation">,</span>
  window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION__ <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建数据存储仓库</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>  <span class="token comment">//暴露出去</span>
</code></pre></div><p>其实就是加了这样一句话.</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION__ <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>这句话的意思就是看window里有没有这个方法，有则执行这个方法（不要被大写的方法名吓到）。</p> <p>这步完成后，就可以启动项目测试一下了，你会发现State数据变的一目了然，以后再进行Redux调试，就会变的非常简单了。</p> <h2 id="通过input体验redux的流程"><a href="#通过input体验redux的流程" class="header-anchor">#</a> 通过Input体验Redux的流程</h2> <p>通过Input的改变，体验一下Redux的整体流程，是如何编写代码的。我们要实现的是在TodoList的Demo中,只要文本框中的值改变就redux中store的值就跟着改变，并且随着Redux中的state值改变，组件也跟着改变。</p> <p><strong>增加Input响应事件</strong></p> <p>如果想Input改变，redux也跟着改变，需要在Input组件上增加onChange响应事件， 打开src目录下的ToDolist.js文件，修改具体代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>Input 
    placeholder<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span> 
    style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token comment">//---------关键代码----start</span>
    onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token punctuation">}</span>
    <span class="token comment">//---------关键代码----end</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>写完这一步，还要记得在constructor进行this的绑定，修改this的指向。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeInputValue</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这步完成后，就可以编写changeInputValue方法的代码了。我们先在控制台打印出文本框的变化，代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后打开浏览器，按F12看一下控制台的结果。这里给出目前的全部代码:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">,</span> List <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeInputValue</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">return</span> <span class="token punctuation">(</span> 
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Input 
                        placeholder<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span> 
                        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
                        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token punctuation">}</span>
                    <span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>List
                        bordered
                        dataSource<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span>
                        renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                    <span class="token operator">/</span><span class="token operator">&gt;</span>    
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p>下面需要作的事就是改变Redux里的值了，我们继续向下学习。</p> <p><strong>创建Action</strong></p> <p>想改变Redux里边State的值就要创建Action了。<strong>Action就是一个对象，这个对象一般有两个属性，第一个是对Action的描述，第二个是要改变的值。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span><span class="token string">'change_input_value'</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>action就创建好了，但是要通过dispatch()方法传递给store。我们在action下面再加入一句代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span><span class="token string">'changeInput'</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这是Action就已经完全创建完成了，也和store有了联系。</p> <p><strong>store的自动推送策略</strong>
已经知道store只是一个仓库，它并没有管理能力，它会把接收到的action自动转发给Reducer。我们现在先直接在Reducer中打印出结果看一下。打开store文件夹下面的reducer.js文件，修改代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>action<span class="token punctuation">)</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p>讲到这里，就可以解释一下两个参数了：</p> <div class="language-sh extra-class"><pre class="language-text"><code>● state: 指的是原始仓库里的状态。
● action: 指的是action新传递的状态。
</code></pre></div><p>通过打印你可以知道，Reducer已经拿到了原来的数据和新传递过来的数据，现在要作的就是改变store里的值。我们先判断type是不是正确的，如果正确，我们需要从新声明一个变量newState。<strong>（记住：Reducer里只能接收state，不能改变state。）</strong>,所以我们声明了一个新变量，然后再次用return返回回去。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'changeInput'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//深度拷贝state</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> action<span class="token punctuation">.</span>value
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p><strong>让组件发生更新</strong></p> <p>现在store里的数据已经更新了，但是组件还没有进行更新，我们需要打开组件文件TodoList.js，在constructor，写入下面的代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeInputValue</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token comment">//----------关键代码-----------start</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">storeChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>  <span class="token comment">//转变this指向</span>
    store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>storeChange<span class="token punctuation">)</span> <span class="token comment">//订阅Redux的状态</span>
    <span class="token comment">//----------关键代码-----------end</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当然我们现在还没有这个storeChange方法，只要写一下这个方法，并且重新setState一次就可以实现组件也是变化的。在代码的最下方，编写storeChange方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">storeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在浏览器中预览，可以看到组件和Redux中都同步进行了改变。</p> <h2 id="redux制作todolist列表"><a href="#redux制作todolist列表" class="header-anchor">#</a> Redux制作ToDoList列表</h2> <p>我们用同样的方法和流程，再开发一遍toDoList里边的列表功能，具体来说就是当点击添加按钮时，ToDoList组件的列表会增加。</p> <p><strong>编写按钮添加响应事件和Action</strong></p> <p>先来编写按钮点击后的响应事件，打开TodoList.js文件，然后在按钮的地方加入onClick事件，记得要进行绑定哦。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>Button 
    type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span>
    onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>clickBtn<span class="token punctuation">}</span>
<span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
</code></pre></div><p>然后在constructor里进行绑定，代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeInputValue</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">storeChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token comment">//关键代码------------start----------</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>clickBtn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clickBtn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token comment">//关键代码------------end----------</span>
    store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>storeChange<span class="token punctuation">)</span> <span class="token comment">//订阅Redux的状态</span>
<span class="token punctuation">}</span>
</code></pre></div><p>绑定之后就可以编写clickBtn()方法了，这里先用一个打印语句代替业务内容。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">clickBtn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候预览一下，点击&quot;增加按钮&quot;，在控制台就可以输出“点击成功”了。说明我们的事件添加成功了。</p> <p><strong>创建Action并用dispatch()传递给store</strong></p> <p>在clickBtn方法里增加Action，然后用dispatch()方法传递给store，代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">clickBtn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token operator">:</span><span class="token string">'addItem'</span><span class="token punctuation">}</span>
   store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候已经把action传递给了store，然后去Reducer里编写业务逻辑就可以了。</p> <p><strong>编写Reducer的业务逻辑</strong>
打开reducer.js文件，先编写代码判断type是不是addItem，如果向redux的list中插入新值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'changeInput'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//深度拷贝state</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> action<span class="token punctuation">.</span>value
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token comment">//关键代码------------------start----------</span>
    <span class="token comment">//state值只能传递，不能使用</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'addItem'</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newState<span class="token punctuation">.</span>inputValue<span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
     <span class="token comment">//关键代码------------------end----------</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p>到这里，我们就能通过输入值，然后点击增加列表。</p> <h2 id="用redux实现todolist的删除功能"><a href="#用redux实现todolist的删除功能" class="header-anchor">#</a> 用Redux实现ToDoList的删除功能</h2> <p><strong>绑定子项响应事件</strong></p> <p>打开src目录下的TodoList.js文件，然后找到List组件的renderItem属性，编写代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>List
        bordered
        dataSource<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span>
        renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">deleteItem</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>    
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>然后编写这个deleteItem()方法，记得它需要接收一个index参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候我们到浏览器预览一下，按F12打开控制台，可以看到点击按钮时可以看到控制台输出了对应的数组下标。</p> <p><strong>在方法里编写Redux的Action</strong></p> <p>写完绑定方法就可以写action了，在编写时，我们要传递index过去，代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span><span class="token string">'deleteItem'</span><span class="token punctuation">,</span>
        index
    <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>reducer业务逻辑的实现</strong></p> <p>编写和传递完action就可以到reducer.js来编写相关的业务逻辑了。其实要作的就是删除数组下标的对应值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'deleteItem'</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//删除数组中对应的值</span>
    <span class="token keyword">return</span> newState
<span class="token punctuation">}</span>
</code></pre></div><p>这时候就做完了这个TodoList组件的基本功能。</p> <h2 id="工作中写redux的小技巧-1"><a href="#工作中写redux的小技巧-1" class="header-anchor">#</a> 工作中写Redux的小技巧-1</h2> <blockquote><p>把自定义的行为类型定义的常量都放在同一个文件中，便于集中管理，同时也避免了两处常量不对应控制台不报错的问题，能够很快的发现问题，并解决。</p></blockquote> <p><strong>把Action Types 单独写入一个文件</strong></p> <p>写Redux Action的时候，我们写了很多Action的派发，产生了很多Action Types，如果需要Action的地方我们就自己命名一个Type,会出现两个基本问题：</p> <div class="language-sh extra-class"><pre class="language-text"><code>● 这些Types如果不统一管理，不利于大型项目的服用，设置会长生冗余代码。
● 因为Action里的Type，一定要和Reducer里的type一一对应在，所以这部分代码或字母写错后，浏览器里并没有明确的报错，这给调试带来了极大的困难。
</code></pre></div><p>那我们就需要把Action Type单独拆分出一个文件。在src/store文件夹下面，新建立一个actionTypes.js文件，然后把Type集中放到文件中进行管理。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span>  <span class="token constant">CHANGE_INPUT</span> <span class="token operator">=</span> <span class="token string">'changeInput'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span>  <span class="token constant">ADD_ITEM</span> <span class="token operator">=</span> <span class="token string">'addItem'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span>  <span class="token constant">DELETE_ITEM</span> <span class="token operator">=</span> <span class="token string">'deleteItem'</span>
</code></pre></div><p><strong>引入Action中并使用</strong></p> <p>写好了ationType.js文件，可以引入到TodoList.js组件当中，引入代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CHANGE_INPUT</span> <span class="token punctuation">,</span> <span class="token constant">ADD_ITEM</span> <span class="token punctuation">,</span> <span class="token constant">DELETE_ITEM</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store/actionTypes'</span>
<span class="token comment">// 或者通过引入所有，然后以对象打点的方式引用，如types.CHANGE_INPUT</span>
<span class="token comment">// import * as types from './store/actionTypes';</span>
</code></pre></div><p>引入后可以在下面的代码中进行使用这些常量代替原来的Type值了.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">,</span>
        value<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">clickBtn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token operator">:</span><span class="token constant">ADD_ITEM</span> <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token punctuation">{</span>  type<span class="token operator">:</span><span class="token constant">DELETE_ITEM</span><span class="token punctuation">,</span> index<span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>引入Reducer并进行更改</strong></p> <p>也是先引入actionType.js文件，然后把对应的字符串换成常量，整个代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">,</span><span class="token constant">ADD_ITEM</span><span class="token punctuation">,</span><span class="token constant">DELETE_ITEM</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./actionTypes'</span>
<span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
    inputValue <span class="token operator">:</span> <span class="token string">'Write Something'</span><span class="token punctuation">,</span>
    list<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">'早上4点起床，锻炼身体'</span><span class="token punctuation">,</span>
        <span class="token string">'中午下班游泳一小时'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">CHANGE_INPUT</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//深度拷贝state</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> action<span class="token punctuation">.</span>value
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token comment">//state值只能传递，不能使用</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">ADD_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newState<span class="token punctuation">.</span>inputValue<span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">DELETE_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p>这样就完成了分离，可以避免冗余代码。还有就是这样如果我们写错了常量名称，程序会直接在浏览器和控制台报错，可以加快开发效率，减少找错时间。</p> <h2 id="工作中写redux的小技巧-2"><a href="#工作中写redux的小技巧-2" class="header-anchor">#</a> 工作中写Redux的小技巧-2</h2> <blockquote><p>将自定义的acitons的类型（type，以及传递的参数）都定义到同一个文件中</p></blockquote> <p><strong>编写actionCreators.js文件</strong></p> <p>在/src/store文件夹下面，建立一个心的文件actionCreators.js，先在文件中引入上节课编写actionTypes.js文件。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">}</span>  <span class="token keyword">from</span> <span class="token string">'./actionTypes'</span>
</code></pre></div><p>引入后可以用const声明一个changeInputAction变量，变量是一个箭头函数，代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">}</span>  <span class="token keyword">from</span> <span class="token string">'./actionTypes'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">changeInputAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">,</span>
    value
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>修改todoList中的代码</strong>
有了文件，就可以把actionCreatores.js引入到TodoLisit中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>changeInputAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store/actionCreatores'</span>
</code></pre></div><p>引入后，可以把changeInputValue()方法，修改为下面的样子。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">changeInputAction</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后再浏览器中打开程序，进行测试，也是完全正常的。</p> <p><strong>修改另两个Action方法</strong></p> <p>安装上面的例子，修改另两个方法，actionCreatores.js全部代码如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">CHANGE_INPUT</span> <span class="token punctuation">,</span> <span class="token constant">ADD_ITEM</span><span class="token punctuation">,</span><span class="token constant">DELETE_ITEM</span><span class="token punctuation">}</span>  <span class="token keyword">from</span> <span class="token string">'./actionTypes'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">changeInputAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">,</span>
    value
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addItemAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token constant">ADD_ITEM</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">deleteItemAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token constant">DELETE_ITEM</span><span class="token punctuation">,</span>
    index
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这个文件写完，可以把TodoList.js文件里的所有action都改为直接调用方法的模式。代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'antd/dist/antd.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">,</span> Button <span class="token punctuation">,</span> List <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span><span class="token punctuation">;</span>
<span class="token comment">//关键代码-------------start</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>changeInputAction <span class="token punctuation">,</span> addItemAction <span class="token punctuation">,</span>deleteItemAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store/actionCreatores'</span><span class="token punctuation">;</span>
<span class="token comment">//关键代码------------end</span>

<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeInputValue</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">storeChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>clickBtn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clickBtn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>storeChange<span class="token punctuation">)</span> <span class="token comment">// 订阅Redux的状态</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> <span class="token punctuation">(</span> 
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Input 
                    placeholder<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span> 
                    style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span><span class="token string">'250px'</span><span class="token punctuation">,</span> marginRight<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
                    onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeInputValue<span class="token punctuation">}</span>
                    value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span>
                <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Button 
                    type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span>
                    onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>clickBtn<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>margin<span class="token operator">:</span><span class="token string">'10px'</span><span class="token punctuation">,</span>width<span class="token operator">:</span><span class="token string">'300px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>List
                    bordered
                    dataSource<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span>
                    renderItem<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">deleteItem</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                <span class="token operator">/</span><span class="token operator">&gt;</span>    
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">storeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'store changed'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//--------关键代码------start</span>
<span class="token function">changeInputValue</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">changeInputAction</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">clickBtn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">addItemAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">deleteItem</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">deleteItemAction</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//--------关键代码------end</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TodoList<span class="token punctuation">;</span>
</code></pre></div><p>都写完了，我们就可以到浏览器中进行查看了，功能也是完全可以的。这节课我们实现Redux Action和业务逻辑的分离，我觉的这一步在你的实际工作中是完全由必要作的。这样可打打提供程序的可维护性。</p> <h2 id="小结-redux填三个小坑"><a href="#小结-redux填三个小坑" class="header-anchor">#</a> 小结-Redux填三个小坑</h2> <p>到这里Redux基础部分也就快结束了，但是我有必要再拿出一节课，把平时你容易犯的错误总结一下。这节课的知识点你可能都已经知道，也可以省略不看。我总结了三个React新手最容易范的错误。</p> <div class="language-sh extra-class"><pre class="language-text"><code>● store必须是唯一的，多个store是坚决不允许，只能有一个store空间
● 只有store能改变自己的内容，Reducer不能改变
● Reducer必须是纯函数
</code></pre></div><p><strong>Store必须是唯一的</strong></p> <p>现在看TodoList.js的代码，就可以看到，这里有一个/store/index.js文件，只在这个文件中用createStore()方法，声明了一个store，之后整个应用都在使用这个store。 下面我给出了index.js内容，可以帮助你更好的回顾。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>  <span class="token comment">//  引入createStore方法</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducer'</span>    
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    reducer<span class="token punctuation">,</span>
    window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION__ <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 创建数据存储仓库</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store   <span class="token comment">//暴露出去</span>
</code></pre></div><p><strong>只有store能改变自己的内容，Reducer不能改变</strong></p> <p>很多新手小伙伴会认为把业务逻辑写在了Reducer中，那改变state值的一定是Reducer，其实不然，在Reducer中我们只是作了一个返回，返回到了store中，并没有作任何改变。我这个在上边的课程中也着重进行了说明。我们再来复习一下Reducer的代码，来加深印象。</p> <p>Reudcer只是返回了更改的数据，但是并没有更改store中的数据，store拿到了Reducer的数据，自己对自己进行了更新。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">CHANGE_INPUT</span><span class="token punctuation">,</span><span class="token constant">ADD_ITEM</span><span class="token punctuation">,</span><span class="token constant">DELETE_ITEM</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./actionTypes'</span>

<span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
    inputValue <span class="token operator">:</span> <span class="token string">'Write Something'</span><span class="token punctuation">,</span>
    list<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">'早上4点起床，锻炼身体'</span><span class="token punctuation">,</span>
        <span class="token string">'中午下班游泳一小时'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">CHANGE_INPUT</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//深度拷贝state</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> action<span class="token punctuation">.</span>value
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token comment">//state值只能传递，不能使用</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">ADD_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newState<span class="token punctuation">.</span>inputValue<span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">DELETE_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Reducer必须是纯函数</strong></p> <p>先来看什么是纯函数，纯函数定义：</p> <div class="tip custom-block"><p class="custom-block-title">纯函数</p> <p>如果函数的调用参数相同，则永远返回相同的结果。它不依赖于程序执行期间函数外部任何状态或数据的变化，必须只依赖于其输入参数。</p></div> <p>这个应该是大学内容，你可能已经忘记了，其实你可以简单的理解为返回的结果是由传入的值决定的，而不是其它的东西决定的。比如下面这段Reducer代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">CHANGE_INPUT</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//深度拷贝state</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> action<span class="token punctuation">.</span>value
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token comment">//state值只能传递，不能使用</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">ADD_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newState<span class="token punctuation">.</span>inputValue<span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        newState<span class="token punctuation">.</span>inputValue <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">DELETE_ITEM</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//根据type值，编写业务逻辑</span>
        <span class="token keyword">let</span> newState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        newState<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//push新的内容到列表中去</span>
        <span class="token keyword">return</span> newState
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><p>它的返回结果，是完全由传入的参数state和action决定的，这就是一个纯函数。这个在实际工作中是如何犯错的？比如在Reducer里增加一个异步ajax函数，获取一些后端接口数据，然后再返回，这就是不允许的（包括你使用日期函数也是不允许的），因为违反了调用参数相同，返回相同的纯函数规则。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react/reactrouter.html" class="prev">
          React Router
        </a></span> <span class="next"><a href="/react/rhooks.html">
          React Hooks
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.af8c451a.js" defer></script><script src="/assets/js/11.dffd68cf.js" defer></script>
  </body>
</html>
